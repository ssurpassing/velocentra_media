# bod_avatars - AI å¤´åƒç”Ÿæˆå™¨

AI é©±åŠ¨çš„ä¸“ä¸šå¤´åƒç”Ÿæˆå™¨ï¼Œä½¿ç”¨å…ˆè¿›çš„ç®¡é“ç³»ç»Ÿå¿«é€Ÿå°†è‡ªæ‹è½¬æ¢ä¸ºé«˜è´¨é‡èŒä¸šå¤´åƒã€‚

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### ğŸ¨ æ ¸å¿ƒåŠŸèƒ½
- **ä¸“ä¸šç®¡é“ç³»ç»Ÿ** - 7é˜¶æ®µä¸“ä¸šç®¡é“å’Œ3é˜¶æ®µå¿«é€Ÿç®¡é“
- **å¤šç§ç”Ÿæˆæ¨¡å¼** - å›¾ç‰‡è½¬å›¾ç‰‡ã€æ–‡æœ¬ç”Ÿæˆå›¾ç‰‡
- **æ™ºèƒ½å¤„ç†** - èƒŒæ™¯ç§»é™¤ã€æ­£è„¸ä¼˜åŒ–ã€äººè„¸ä¸€è‡´æ€§ä¿æŒ
- **è´¨é‡è¯„ä¼°** - è‡ªåŠ¨è´¨é‡è¯„åˆ†å’Œä¼˜åŒ–

### ğŸŒ å›½é™…åŒ–æ”¯æŒ
- æ”¯æŒ 7 ç§è¯­è¨€ï¼šä¸­æ–‡ã€è‹±æ–‡ã€æ—¥è¯­ã€éŸ©è¯­ã€æ³•è¯­ã€å¾·è¯­ã€è¥¿ç­ç‰™è¯­
- å®Œæ•´çš„å¤šè¯­è¨€ç•Œé¢

### ğŸ’ ä»˜è´¹æ¨¡å¼
- å…è´¹è¯•ç”¨ï¼šæ¯ç”¨æˆ·3æ¬¡å…è´¹ç”Ÿæˆ
- ç§¯åˆ†åˆ¶åº¦ï¼šæŒ‰æ¬¡ä»˜è´¹ï¼Œçµæ´»ä½¿ç”¨
- å…è´¹é‡è¯•ï¼šé¦–æ¬¡ç”Ÿæˆå¤±è´¥å¯å…è´¹é‡è¯•ä¸€æ¬¡

### ğŸ–¼ï¸ ç”»å»ŠåŠŸèƒ½
- å…¬å¼€ç”»å»Šï¼šåˆ†äº«ä½ çš„ä½œå“
- ç²¾é€‰ä½œå“ï¼šå±•ç¤ºæœ€ä½³æ•ˆæœ
- ä¸ªäººç›¸å†Œï¼šç®¡ç†ä½ çš„ç”Ÿæˆå†å²

## ğŸ—ï¸ æŠ€æœ¯æ ˆ

### å‰ç«¯
- **æ¡†æ¶**: Next.js 14 (App Router)
- **è¯­è¨€**: TypeScript
- **æ ·å¼**: Tailwind CSS
- **UI ç»„ä»¶**: Radix UI
- **å›½é™…åŒ–**: next-intl

### åç«¯
- **æ•°æ®åº“**: Supabase (PostgreSQL)
- **è®¤è¯**: Supabase Auth
- **å­˜å‚¨**: Supabase Storage
- **æ”¯ä»˜**: Stripe
- **é‚®ä»¶**: Resend

### AI æœåŠ¡
- **å›¾åƒç”Ÿæˆ**: Replicate (SDXL)
- **æ–‡æœ¬ç”Ÿæˆ**: Google Gemini
- **å›¾åƒå¤„ç†**: 
  - èƒŒæ™¯ç§»é™¤: BRIA-RMBG
  - äººè„¸ä¿®å¤: CodeFormer
  - æ­£è„¸ä¼˜åŒ–: HyperHuman
  - äººè„¸ä¸€è‡´æ€§: PuLID

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
npm install
```

### 2. é…ç½®ç¯å¢ƒå˜é‡

å¤åˆ¶ `.env.template` åˆ° `.env.local` å¹¶å¡«å†™é…ç½®ï¼š

```bash
cp .env.template .env.local
```

å¿…éœ€é…ç½®ï¼š
- `NEXT_PUBLIC_SUPABASE_URL` - Supabase é¡¹ç›®URL
- `NEXT_PUBLIC_SUPABASE_ANON_KEY` - Supabase åŒ¿åå¯†é’¥
- `SUPABASE_SERVICE_ROLE_KEY` - Supabase æœåŠ¡å¯†é’¥
- `REPLICATE_API_TOKEN` - Replicate API Token
- `STRIPE_SECRET_KEY` - Stripe å¯†é’¥
- `RESEND_API_KEY` - Resend API å¯†é’¥

### 3. è®¾ç½®æ•°æ®åº“

åœ¨ Supabase Dashboard çš„ SQL Editor ä¸­æ‰§è¡Œ `supabase/init.sql`ï¼š

```sql
-- å¤åˆ¶ç²˜è´´ supabase/init.sql çš„å…¨éƒ¨å†…å®¹å¹¶æ‰§è¡Œ
```

è¿™å°†åˆ›å»ºæ‰€æœ‰å¿…éœ€çš„è¡¨ã€ç´¢å¼•ã€RLSç­–ç•¥ã€è§¦å‘å™¨å’Œå­˜å‚¨æ¡¶ã€‚

**æ³¨æ„**ï¼šå¦‚æœä½ å·²ç»æœ‰æ—§è¡¨ï¼Œè¯·å…ˆåœ¨ Supabase Dashboard åˆ é™¤å®ƒä»¬ï¼Œç„¶åå†è¿è¡Œ `init.sql`ã€‚

### 4. é…ç½® Supabase Storage

**é‡è¦**: ä¸ºäº†è®©å¤–éƒ¨AI API (å¦‚KIE) èƒ½å¤Ÿè®¿é—®ç”¨æˆ·ä¸Šä¼ çš„å›¾ç‰‡,éœ€è¦å°†å­˜å‚¨æ¡¶è®¾ç½®ä¸º publicã€‚

åœ¨ Supabase Dashboard çš„ SQL Editor ä¸­æ‰§è¡Œ:

```bash
# åœ¨ SQL Editor ä¸­è¿è¡Œ
scripts/setup-supabase-storage.sql
```

æˆ–è€…æ‰‹åŠ¨é…ç½®:
1. è¿›å…¥ **Storage** â†’ **Buckets**
2. æ‰¾åˆ° `originals` å’Œ `avatars` æ¡¶
3. å°†å®ƒä»¬éƒ½è®¾ç½®ä¸º **Public**

éªŒè¯é…ç½®æ˜¯å¦æ­£ç¡®:

```bash
npm run verify-storage
```

è¯¦ç»†è¯´æ˜è¯·å‚è€ƒ: [IMAGE_URL_FIX.md](./IMAGE_URL_FIX.md)

### 5. è¿è¡Œå¼€å‘æœåŠ¡å™¨

```bash
npm run dev
```

è®¿é—® [http://localhost:3000](http://localhost:3000)

## ğŸ“ é¡¹ç›®ç»“æ„

```
src/
â”œâ”€â”€ app/                    # Next.js App Router
â”‚   â”œâ”€â”€ [locale]/           # å›½é™…åŒ–è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ auth/           # è®¤è¯é¡µé¢
â”‚   â”‚   â”œâ”€â”€ creative/       # åˆ›æ„ç”»å»Š
â”‚   â”‚   â”œâ”€â”€ generate/       # ç”Ÿæˆé¡µé¢
â”‚   â”‚   â”œâ”€â”€ pricing/        # å®šä»·é¡µé¢
â”‚   â”‚   â”œâ”€â”€ result/         # ç»“æœé¡µé¢
â”‚   â”‚   â””â”€â”€ tasks/          # ä»»åŠ¡è¯¦æƒ…
â”‚   â””â”€â”€ api/                # API è·¯ç”±
â”‚       â”œâ”€â”€ auth/           # è®¤è¯API
â”‚       â”œâ”€â”€ gallery/        # ç”»å»ŠAPI
â”‚       â”œâ”€â”€ generate/       # ç®€å•ç”ŸæˆAPI
â”‚       â”œâ”€â”€ generate-professional/  # ä¸“ä¸šç®¡é“API
â”‚       â”œâ”€â”€ payment/        # æ”¯ä»˜API
â”‚       â”œâ”€â”€ photos/         # ç…§ç‰‡ç®¡ç†API
â”‚       â”œâ”€â”€ tasks/          # ä»»åŠ¡API
â”‚       â”œâ”€â”€ upload/         # ä¸Šä¼ API
â”‚       â””â”€â”€ user/           # ç”¨æˆ·API
â”œâ”€â”€ features/               # åŠŸèƒ½æ¨¡å—
â”‚   â”œâ”€â”€ creative/           # åˆ›æ„ç”»å»ŠåŠŸèƒ½
â”‚   â””â”€â”€ home/               # ä¸»é¡µåŠŸèƒ½
â”œâ”€â”€ infrastructure/         # åŸºç¡€è®¾æ–½
â”‚   â”œâ”€â”€ database/           # æ•°æ®åº“å®¢æˆ·ç«¯
â”‚   â”œâ”€â”€ http/               # HTTP å®¢æˆ·ç«¯
â”‚   â””â”€â”€ services/           # å¤–éƒ¨æœåŠ¡
â”‚       â”œâ”€â”€ ai/             # AI æœåŠ¡
â”‚       â”œâ”€â”€ email/          # é‚®ä»¶æœåŠ¡
â”‚       â”œâ”€â”€ payment/        # æ”¯ä»˜æœåŠ¡
â”‚       â”œâ”€â”€ pipeline/       # ç®¡é“ç³»ç»Ÿ â­
â”‚       â”‚   â”œâ”€â”€ base/       # åŸºç¡€ç®¡é“ç±»
â”‚       â”‚   â”œâ”€â”€ orchestrator.ts  # ç®¡é“ç¼–æ’å™¨
â”‚       â”‚   â”œâ”€â”€ pipelines/  # ç®¡é“å®ç°
â”‚       â”‚   â”‚   â”œâ”€â”€ fast/   # å¿«é€Ÿç®¡é“
â”‚       â”‚   â”‚   â”œâ”€â”€ professional/  # ä¸“ä¸šç®¡é“
â”‚       â”‚   â”‚   â””â”€â”€ PipelineFactory.ts
â”‚       â”‚   â”œâ”€â”€ stages/     # ç®¡é“é˜¶æ®µ
â”‚       â”‚   â””â”€â”€ utils/      # å·¥å…·å‡½æ•°
â”‚       â””â”€â”€ storage/        # å­˜å‚¨æœåŠ¡
â””â”€â”€ shared/                 # å…±äº«èµ„æº
    â”œâ”€â”€ components/         # UI ç»„ä»¶
    â”œâ”€â”€ config/             # é…ç½®
    â”œâ”€â”€ contexts/           # React ä¸Šä¸‹æ–‡
    â”œâ”€â”€ hooks/              # è‡ªå®šä¹‰ Hooks
    â”œâ”€â”€ lib/                # å·¥å…·å‡½æ•°
    â””â”€â”€ types/              # ç±»å‹å®šä¹‰
```

## ğŸ¯ ç®¡é“ç³»ç»Ÿ

æœ¬é¡¹ç›®é‡‡ç”¨å…ˆè¿›çš„ç®¡é“ç³»ç»Ÿï¼Œæ”¯æŒä¸¤ç§ç”Ÿæˆæ¨¡å¼ï¼š

### ä¸“ä¸šç®¡é“ (Professional Pipeline)
- **é˜¶æ®µæ•°**: 7ä¸ªé˜¶æ®µ
- **æ¶ˆè€—ç§¯åˆ†**: 150ç§¯åˆ†
- **é¢„è®¡è€—æ—¶**: 15-25ç§’
- **åŒ…å«åŠŸèƒ½**:
  1. äººåƒæŠ å›¾ (BRIA-RMBG)
  2. æ­£è„¸ä¼˜åŒ– (HyperHuman)
  3. äººè„¸ä¸€è‡´æ€§ (PuLID)
  4. ä¸“ä¸šèƒŒæ™¯åˆæˆ
  5. AIäººè„¸ä¿®å¤ (CodeFormer)
  6. æœ€ç»ˆå¢å¼º
  7. è´¨é‡è¯„ä¼°

### å¿«é€Ÿç®¡é“ (Fast Pipeline)
- **é˜¶æ®µæ•°**: 3ä¸ªé˜¶æ®µ
- **æ¶ˆè€—ç§¯åˆ†**: 50ç§¯åˆ†
- **é¢„è®¡è€—æ—¶**: 5-10ç§’
- **åŒ…å«åŠŸèƒ½**:
  1. äººåƒæŠ å›¾
  2. äººè„¸ä¸€è‡´æ€§
  3. è´¨é‡ä¼˜åŒ–

## ğŸ’° å®šä»·

### ç§¯åˆ†å¥—é¤
- **åŸºç¡€å¥—é¤**: 100ç§¯åˆ† - $9.99
- **æ ‡å‡†å¥—é¤**: 300ç§¯åˆ† - $24.99
- **ä¸“ä¸šå¥—é¤**: 1000ç§¯åˆ† - $69.99

### ä½¿ç”¨æˆæœ¬
- **å¿«é€Ÿç®¡é“**: 50ç§¯åˆ†/æ¬¡
- **ä¸“ä¸šç®¡é“**: 150ç§¯åˆ†/æ¬¡

## ğŸ”§ éƒ¨ç½²

### Vercel éƒ¨ç½²

1. æ¨é€ä»£ç åˆ° GitHub
2. åœ¨ Vercel å¯¼å…¥é¡¹ç›®
3. é…ç½®ç¯å¢ƒå˜é‡
4. éƒ¨ç½²

### ç¯å¢ƒå˜é‡é…ç½®

ç¡®ä¿åœ¨ç”Ÿäº§ç¯å¢ƒé…ç½®æ‰€æœ‰å¿…éœ€çš„ç¯å¢ƒå˜é‡ï¼Œè¯¦è§ `.env.template`ã€‚

## ğŸ“Š æ•°æ®åº“æ¶æ„

### æ ¸å¿ƒè¡¨
- `user_profiles` - ç”¨æˆ·é…ç½®
- `generation_tasks` - ç”Ÿæˆä»»åŠ¡
- `generated_photos` - ç”Ÿæˆçš„ç…§ç‰‡
- `folders` - ç…§ç‰‡æ–‡ä»¶å¤¹
- `transactions` - äº¤æ˜“è®°å½•
- `credit_history` - ç§¯åˆ†å†å²

### ä¸»è¦åŠŸèƒ½
- è¡Œçº§å®‰å…¨ (RLS)
- è‡ªåŠ¨è§¦å‘å™¨
- è¾…åŠ©å‡½æ•°
- ç»Ÿè®¡è§†å›¾

è¯¦ç»†æ¶æ„è¯·å‚è€ƒ `supabase/init.sql`ã€‚

## ğŸ”’ å®‰å…¨

- RLSï¼ˆè¡Œçº§å®‰å…¨ï¼‰ä¿æŠ¤æ‰€æœ‰æ•°æ®è¡¨
- JWT è®¤è¯
- API å¯†é’¥åŠ å¯†å­˜å‚¨
- HTTPS å¼ºåˆ¶ä¼ è¾“
- CORS é…ç½®

## ğŸ“ å¼€å‘æŒ‡å—

### æ·»åŠ æ–°çš„ç®¡é“é˜¶æ®µ

1. åœ¨ `src/infrastructure/services/pipeline/stages/` åˆ›å»ºæ–°é˜¶æ®µ
2. ç»§æ‰¿ `BasePipeline` å¹¶å®ç° `executeStage` æ–¹æ³•
3. åœ¨ç®¡é“é…ç½®ä¸­æ³¨å†Œæ–°é˜¶æ®µ

### æ·»åŠ æ–°çš„è¯­è¨€

1. åœ¨ `locales/[lang]/common.json` æ·»åŠ ç¿»è¯‘
2. åœ¨ `src/i18n/config.ts` æ³¨å†Œè¯­è¨€

## ğŸ› å¸¸è§é—®é¢˜

### æ•°æ®åº“è¿æ¥å¤±è´¥
- æ£€æŸ¥ Supabase URL å’Œå¯†é’¥æ˜¯å¦æ­£ç¡®
- ç¡®è®¤æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬å·²æ‰§è¡Œ

### å›¾ç‰‡ç”Ÿæˆå¤±è´¥
- æ£€æŸ¥ Replicate API Token
- ç¡®è®¤è´¦æˆ·ä½™é¢å……è¶³
- æŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—è·å–è¯¦ç»†é”™è¯¯

### æ”¯ä»˜å¤±è´¥
- æ£€æŸ¥ Stripe å¯†é’¥é…ç½®
- ç¡®è®¤ Webhook ç«¯ç‚¹æ­£ç¡®è®¾ç½®

## ğŸ“„ License

MIT

## ğŸ™ è‡´è°¢

- [Replicate](https://replicate.com) - AI æ¨¡å‹æ‰˜ç®¡
- [Supabase](https://supabase.com) - åç«¯æœåŠ¡
- [Vercel](https://vercel.com) - éƒ¨ç½²å¹³å°
- [Stripe](https://stripe.com) - æ”¯ä»˜å¤„ç†

## ğŸ“§ è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·æäº¤ Issueã€‚

---

Made with â¤ï¸ by bod_avatars Team
